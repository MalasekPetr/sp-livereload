{"version":3,"file":"BrandingInfo.js","sourceRoot":"","sources":["../../../src/extensions/components/BrandingInfo.ts"],"names":[],"mappings":"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","sourcesContent":["import ThemeColors from \"../common/ThemeColors\";\nimport { Dialog } from \"./Dialog\";\n\nconst filterFonts = ['Segoe UI', 'Leelawadee', 'Fluent', 'Fabric', 'Shell'];\n\n\nexport class Branding {\n\n  private _dialog: Dialog;\n  private _dialogContent: HTMLElement;\n  private _themeInfo: HTMLElement;\n\n  private _registeredCustomFonts: Array<FontFace> = [];\n\n  constructor() {\n\n    this._dialog = new Dialog('Branding Information', 'pnp-lr-brandinfo');\n    this._dialog.classList.add('pnp-lr-brandinfo');\n\n    const content: HTMLElement | null = this._dialog.querySelector('.dlg-content');\n\n    if (!content) {\n      console.error(`Dialog Content couldn't found`)\n      return;\n    }\n\n    this._dialogContent = content;\n\n\n    // this._dialog.append(this._dialogContent);\n\n    this.getThemeColors();\n\n    // this.allResources();\n\n    // eslint-disable-next-line no-void\n    void this.getRegisteredFonts();\n\n  }\n\n  // private allResources() {\n\n  //   const entries = window.performance.getEntriesByType('resource');\n  //   entries.filter(item => {\n\n  //     if (item.name.toLowerCase().indexOf('gotham') !== -1) {\n  //       console.debug(item.name);\n  //     }\n  //   })\n  //   console.debug('RESOURCES ::::: ', entries);\n\n  // }\n\n  private async getRegisteredFonts(): Promise<void> {\n\n    const fonts = await document.fonts as FontFaceSet;\n\n    await this.getFonts(fonts);\n\n    if (this._registeredCustomFonts.length !== 0) {\n\n      const fontContent = document.createElement('section');\n      fontContent.classList.add('pnp-lr-fonts');\n      fontContent.innerHTML = '<h3>Fonts registed on the page</h3>';\n\n      const fontMenu = document.createElement('ul');\n      fontMenu.classList.add('pnp-lr-fontmenu');\n\n      for (let i = 0; i < this._registeredCustomFonts.length; i++) {\n\n        const curFont = this._registeredCustomFonts[i];\n\n        const fontMenuItem = document.createElement('li');\n        fontMenuItem.textContent = curFont.family;\n        fontMenuItem.style.fontFamily = curFont.family;\n\n        fontMenu.append(fontMenuItem);\n\n        // const compStyles = window.getComputedStyle(fontMenuItem);\n\n      }\n\n      fontContent.append(fontMenu)\n\n      this._dialogContent.append(fontContent);\n\n    }\n\n\n\n  }\n\n  async getFonts(fonts: FontFaceSet) {\n\n    const promises: FontFace[] = [];\n\n    fonts.forEach(font => promises.push(font));\n\n    const data = await Promise.all(promises);\n\n    for (let i = 0; i < data.length; i++) {\n\n      if (!filterFonts.some(fontName => data[i].family.includes(fontName))) {\n        this._registeredCustomFonts.push(data[i]);\n      }\n    }\n\n  }\n\n  private getThemeColors() {\n\n    this._themeInfo = document.createElement('section');\n    this._themeInfo.innerHTML = '<h3>Theme Colors</h3>';\n\n    const themeColors = ThemeColors.theme;\n    const themeColorKeys: string[] = Object.keys(themeColors);\n\n    const themeColorMenu = document.createElement('menu');\n    themeColorMenu.classList.add('theme-colors');\n    const colorIds: string[] = [];\n\n    themeColorKeys.forEach(item => {\n\n      const itemId = themeColors[item].name.replace(/ /g, '');\n      colorIds.push(itemId);\n\n      const menuItem = document.createElement('li');\n      const menuItemButton = document.createElement('button');\n      menuItem.append(menuItemButton);\n      menuItemButton.id = itemId;\n      menuItemButton.classList.add('color-swatch');\n      menuItemButton.style.background = themeColors[item].value;\n      menuItemButton.innerHTML = `<span class='visually-hidden'>${themeColors[item].name}</span>`;\n      menuItemButton.ariaLabel = `${themeColors[item].name} - Click for more details`;\n      menuItemButton.addEventListener('click', this.showColorInformation);\n\n      themeColorMenu.append(menuItem);\n\n    })\n\n    const themeColorOutput = document.createElement('output');\n    themeColorOutput.classList.add('color-swatch-output');\n    themeColorOutput.id = 'theme-color-desc';\n    themeColorOutput.textContent = \"Pick color to show informaiton\";\n    themeColorOutput.setAttribute('for', colorIds.join(' '))\n\n    themeColorMenu.append(themeColorOutput);\n\n    const neutralsColors = ThemeColors.neutrals;\n    const neutralsKeys: string[] = Object.keys(neutralsColors);\n\n    const neutralsColorMenu = document.createElement('menu');\n    neutralsColorMenu.classList.add('theme-colors');\n\n    const neutralsIds: string[] = [];\n\n    neutralsKeys.forEach(item => {\n\n      const itemId = neutralsColors[item].name.replace(/ /g, '');\n      neutralsIds.push(itemId);\n\n      const menuItem = document.createElement('li');\n      const menuItemButton = document.createElement('button');\n      menuItem.append(menuItemButton);\n\n      menuItemButton.classList.add('color-swatch');\n      menuItemButton.id = itemId;\n      menuItemButton.style.background = neutralsColors[item].value;\n      menuItemButton.innerHTML = `<span class='visually-hidden'>${neutralsColors[item].name}</span>`;\n      menuItemButton.ariaLabel = `${neutralsColors[item].name} - Click for more details`\n      menuItemButton.addEventListener('click', this.showColorInformation);\n\n      neutralsColorMenu.append(menuItem);\n\n    })\n\n    const neutralsColorOutput = document.createElement('output');\n    neutralsColorOutput.classList.add('color-swatch-output');\n    neutralsColorOutput.id = 'neutral-color-desc';\n    neutralsColorOutput.textContent = \"Pick color to show informaiton\";\n    neutralsColorOutput.setAttribute('for', neutralsIds.join(' '));\n\n    neutralsColorMenu.append(neutralsColorOutput);\n\n    const inBetweenHeadling = document.createElement('h3');\n    inBetweenHeadling.textContent = \"Neutral Colors\";\n\n    this._themeInfo.append(themeColorMenu);\n    this._themeInfo.append(inBetweenHeadling);\n    this._themeInfo.append(neutralsColorMenu);\n\n    this._dialogContent.append(this._themeInfo);\n\n  }\n\n  private showColorInformation = (event: Event) => {\n\n    if (event.target) {\n\n      const curentTarget = event.target as HTMLElement;\n\n      const outputElement = this._dialogContent.querySelector(`[for*='${curentTarget.id}']`) as HTMLElement;\n\n      if (outputElement) {\n\n        if (curentTarget.textContent) {\n\n          const compStyle = window.getComputedStyle(curentTarget);\n\n          outputElement.innerHTML = `<span class='visually-hidden'>Current selected Color:</span>${curentTarget.textContent} / ${compStyle.getPropertyValue('background-color')} / ${curentTarget.style.background}`;\n\n        }\n\n      }\n\n    }\n\n  }\n\n  public get Info(): HTMLDialogElement {\n    return this._dialog;\n  }\n\n}"]}